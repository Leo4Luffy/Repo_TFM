<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.442">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tutorial básico con SeqBreed - Precisión de la predición mediante simulación con SeqBreed</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<link href="./model.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="css/bloques.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Precisión de la predición mediante simulación con SeqBreed</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Tutorial básico con SeqBreed</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Leo4Luffy/Repo_TFM/tree/main/TFM_resultados" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Bienvenido</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">Los datos</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model.html" class="sidebar-item-text sidebar-link">Modelos de predicción</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seqbreed.html" class="sidebar-item-text sidebar-link active">Precisión de la predición mediante simulación con SeqBreed</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#uso-de-genotipos-de-la-población-fundadora" id="toc-uso-de-genotipos-de-la-población-fundadora" class="nav-link active" data-scroll-target="#uso-de-genotipos-de-la-población-fundadora">1. Uso de genotipos de la población fundadora</a></li>
  <li><a href="#especificación-de-la-arquitectura-genética-snp-causales-qtn-y-sus-efectos" id="toc-especificación-de-la-arquitectura-genética-snp-causales-qtn-y-sus-efectos" class="nav-link" data-scroll-target="#especificación-de-la-arquitectura-genética-snp-causales-qtn-y-sus-efectos">2. Especificación de la arquitectura genética (SNP causales (QTN) y sus efectos)</a></li>
  <li><a href="#generación-de-pedigríes" id="toc-generación-de-pedigríes" class="nav-link" data-scroll-target="#generación-de-pedigríes">3. Generación de pedigríes</a></li>
  <li><a href="#uso-de-subconjuntos-de-datos-con-diferentes-densidades-de-snp" id="toc-uso-de-subconjuntos-de-datos-con-diferentes-densidades-de-snp" class="nav-link" data-scroll-target="#uso-de-subconjuntos-de-datos-con-diferentes-densidades-de-snp">4. Uso de subconjuntos de datos con diferentes densidades de SNP</a></li>
  <li><a href="#implementación-de-los-métodos-blup-y-ssgblup" id="toc-implementación-de-los-métodos-blup-y-ssgblup" class="nav-link" data-scroll-target="#implementación-de-los-métodos-blup-y-ssgblup">5. Implementación de los métodos BLUP y ssGBLUP</a></li>
  <li><a href="#referencia-bibliográfica" id="toc-referencia-bibliográfica" class="nav-link" data-scroll-target="#referencia-bibliográfica">Referencia bibliográfica</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/Leo4Luffy/Repo_TFM/edit/master/tree/main/TFM_resultados/seqbreed.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Precisión de la predición mediante simulación con SeqBreed</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Hoy en día, los métodos de predicción genómica se usan ampliamente en la mejora genética de plantas y de animales. Antes de que estos métodos sean implementados en escenarios prácticos, es importante conocer su precisión al predecir el valor de cría estimado (EBV, o GEBV al realizar la predicción utilizando SNP). En este sentido, uno de los objetivos de mi trabajo de grado consistió en estudiar el efecto del número de marcadores (SNP) sobre la precisión del GEBV para el carácter tiempo de floración en el arroz. Para ello, se realizó un estudio de simulación a partir del uso del módulo <code>SeqBreed</code> <span class="citation" data-cites="pérez-enciso2020">(<a href="#ref-pérez-enciso2020" role="doc-biblioref">Pérez-Enciso, Ramírez-Ayala, and Zingaretti 2020</a>)</span> del lenguaje de programación <code>Python</code><span class="citation" data-cites="Python">(<a href="#ref-Python" role="doc-biblioref">Van-Rossum and Drake 1995</a>)</span>.</p>
<p>Cada uno de los pasos llevados a cabo en dicho estudio de simulación los describiré a continuación (<a href="#fig-seqbreed">Figure&nbsp;<span>1</span></a>).</p>
<div class="cell">

</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-seqbreed" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="seqbreed_files/figure-html/fig-seqbreed-1.png" class="img-fluid figure-img" style="width:74.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 1: Esquema de predicción usando simulación con el paquete SeqBreed.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="uso-de-genotipos-de-la-población-fundadora" class="level3">
<h3 class="anchored" data-anchor-id="uso-de-genotipos-de-la-población-fundadora">1. Uso de genotipos de la población fundadora</h3>
<p>Para simular los datos de fenotipo y de genotipo se usaron los datos con los 100.231 SNP resultantes del control de calidad y que puede descargar en el capítulo donde se describen los datos. Luego, usando las funciones <code>gg.GFounder()</code> y <code>gg.Genome()</code>, como se puede observar en el código a continuación, se obtuvo un archivo que indicó el número de individuos genotipados o individuos de la población fundadora (451), la ploidía (2) y el número de SNP (100.231).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>SNP_pos <span class="op">=</span> <span class="st">'SNP_pos'</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Gen_Pob_base <span class="op">=</span> gg.GFounder(vcfFile <span class="op">=</span> vcf_IND, snpFile <span class="op">=</span> SNP_pos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="codigo">
<p>Con el argumento <code>vcfFile</code> de la función <code>gg.GFounder()</code>, se carga los genotipos de la llamada población fundadora en formato variant call. Con esta función se obtiene la posición de cada uno de los SNP, y esta a su vez se almacena en el objeto SNP_pos previamente definido.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Gen_caracteristicas <span class="op">=</span> gg.Genome(snpFile <span class="op">=</span> SNPs_pos, mapFile <span class="op">=</span> <span class="va">None</span>, ploidy <span class="op">=</span> Gen_Pob_base.ploidy,  XChr <span class="op">=</span> <span class="st">'X'</span>, YChr <span class="op">=</span> <span class="st">'Y'</span>, MTChr <span class="op">=</span> <span class="st">'MT'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="codigo">
<p>Con la función <code>gg.Genome()</code> se genera un objeto de clase <code>Genome</code> con algunas de las características del genoma de la población fundadora, como son el nombre y el número de cromosomas. Con el argumento <code>snpFile</code> se especifica el objeto SNP_pos generado en el paso anterior, además de que si se dispone del nombre de los cromosomas sexuales y mitocondrial, estos se especifican en los argumentos <code>XChr</code>, <code>YChr</code> y <code>MT</code>. Aquí, no se dispuso de un archivo con información acerca de recombinación genética y mapeo de genes, por lo cual en el argumento <code>mapFile</code> se colocó “None”.</p>
</div>
</section>
<section id="especificación-de-la-arquitectura-genética-snp-causales-qtn-y-sus-efectos" class="level3">
<h3 class="anchored" data-anchor-id="especificación-de-la-arquitectura-genética-snp-causales-qtn-y-sus-efectos">2. Especificación de la arquitectura genética (SNP causales (QTN) y sus efectos)</h3>
<p>Se llevo a cabo inicialmente un estudio de asociación a nivel genómico (GWAS) usando el software <code>GCTA</code><span class="citation" data-cites="yang2011">(<a href="#ref-yang2011" role="doc-biblioref">Yang et al. 2011</a>)</span>, para identificar las regiones genómicas asociadas con el carácter tiempo de floración. A continuación podrá descargar el archivo que resultó al hacer el GWAS, donde se específica el efecto de los QTN y su localización.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><i class="bi bi-download"></i> <a href="datos/gwas.mlma" download="gwas.mlma">Datos GWAS</a></p>
</div>
</div>
</div>
<p>Posteriomente, con base en el GWAS (<a href="#fig-GWAS">Figure&nbsp;<span>2</span></a>), se seleccionaron 50 QTN cuyo efecto era proporcional a la varianza aditiva explicada.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-GWAS" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="seqbreed_files/figure-html/fig-GWAS-1.png" class="img-fluid figure-img" style="width:74.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 2: Visualización del GWAS para el carácter tiempo de floración en el arroz.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>A continuación podrá descargar los 50 QTN seleccionados.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><i class="bi bi-download"></i> <a href="datos/QTN.txt" download="QTN.txt">Datos QTN</a></p>
</div>
</div>
</div>
<p>Por último, se usó la función <code>gg.QTNs()</code> sobre estos datos generados, indicando también la heredabilidad del carácter (0.7) de acuerdo a resultados previamente reportados <span class="citation" data-cites="Vourlakietal">(<a href="#ref-Vourlakietal" role="doc-biblioref">Vourlaki et al. s.f.</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>QTN <span class="op">=</span> <span class="st">'QTN.txt'</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>QTNs <span class="op">=</span> gg.QTNs(h2 <span class="op">=</span> [<span class="fl">0.7</span>], genome <span class="op">=</span> Gen_caracteristicas, qtnFile <span class="op">=</span> QTN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="codigo">
<p>Con la función <code>gg.QTNs()</code> se determina la arquitectura genética para el carácter simulado. Para ello, se especifica un valor deseado de heredabilidad con el argumento <code>h2</code>, se carga el archivo QTN.txt que indica el efecto y la localización de cada uno de los QTN seleccionados anteriormente con el argumento <code>qtnFile</code>, y con el argumento <code>genome</code> se accede a las características del genoma previamente almacenado.</p>
</div>
</section>
<section id="generación-de-pedigríes" class="level3">
<h3 class="anchored" data-anchor-id="generación-de-pedigríes">3. Generación de pedigríes</h3>
<p>Inicialmente, se generaron cuatro pedigríes, cada uno de ellos con esquemas de cruzamiento diferentes partiendo de la población fundadora con 451 individuos.</p>
<div class="cell">
<div class="cell-output-display">

<div id="ihbabwnrxm" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ihbabwnrxm .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ihbabwnrxm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ihbabwnrxm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ihbabwnrxm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ihbabwnrxm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ihbabwnrxm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ihbabwnrxm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ihbabwnrxm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ihbabwnrxm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ihbabwnrxm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ihbabwnrxm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ihbabwnrxm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ihbabwnrxm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ihbabwnrxm .gt_from_md > :first-child {
  margin-top: 0;
}

#ihbabwnrxm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ihbabwnrxm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ihbabwnrxm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ihbabwnrxm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ihbabwnrxm .gt_row_group_first td {
  border-top-width: 2px;
}

#ihbabwnrxm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihbabwnrxm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ihbabwnrxm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ihbabwnrxm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ihbabwnrxm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihbabwnrxm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ihbabwnrxm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ihbabwnrxm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ihbabwnrxm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ihbabwnrxm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihbabwnrxm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ihbabwnrxm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihbabwnrxm .gt_left {
  text-align: left;
}

#ihbabwnrxm .gt_center {
  text-align: center;
}

#ihbabwnrxm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ihbabwnrxm .gt_font_normal {
  font-weight: normal;
}

#ihbabwnrxm .gt_font_bold {
  font-weight: bold;
}

#ihbabwnrxm .gt_font_italic {
  font-style: italic;
}

#ihbabwnrxm .gt_super {
  font-size: 65%;
}

#ihbabwnrxm .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#ihbabwnrxm .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ihbabwnrxm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ihbabwnrxm .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#ihbabwnrxm .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#ihbabwnrxm .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"> </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Pedigrí 1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Pedigri 2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Pedigrí 3</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Pedigrí 4</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">F0</td>
<td class="gt_row gt_left">451</td>
<td class="gt_row gt_left">451</td>
<td class="gt_row gt_left">451</td>
<td class="gt_row gt_left">451</td></tr>
    <tr><td class="gt_row gt_left">F1</td>
<td class="gt_row gt_left">10<sup class="gt_footnote_marks">1</sup></td>
<td class="gt_row gt_left">20</td>
<td class="gt_row gt_left">40</td>
<td class="gt_row gt_left">80</td></tr>
    <tr><td class="gt_row gt_left">F2</td>
<td class="gt_row gt_left">800 (10x80)<sup class="gt_footnote_marks">2</sup></td>
<td class="gt_row gt_left">800 (20x40)</td>
<td class="gt_row gt_left">800 (40x20)</td>
<td class="gt_row gt_left">800 (80x10)</td></tr>
    <tr><td class="gt_row gt_left">F3</td>
<td class="gt_row gt_left">800 (800x1)<sup class="gt_footnote_marks">3</sup></td>
<td class="gt_row gt_left">800 (800x1)</td>
<td class="gt_row gt_left">800 (800x1)</td>
<td class="gt_row gt_left">800 (800x1)</td></tr>
    <tr><td class="gt_row gt_left">Total</td>
<td class="gt_row gt_left">2.061</td>
<td class="gt_row gt_left">2.071</td>
<td class="gt_row gt_left">2.091</td>
<td class="gt_row gt_left">2.131</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><sup class="gt_footnote_marks">1</sup> 10 indica el número de descendientes que tendrían los 451 individuos de la generación F0 mediante cruzamiento.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><sup class="gt_footnote_marks">2</sup> 10x80 indica el número de descendientes (80) que tendrían cada uno de los 10 individuos de la generación F1 por autofecundación, dando un total de 800 individuos en la generación F2.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><sup class="gt_footnote_marks">3</sup> 800x1 indica el número de descendientes (1) que tendrían cada uno de los 800 individuos de la generación F2 por autofecundación, dando un total de 800 individuos en la generación F3.</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>A continuación podrá descargar los cuatro pedigríes generados.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><i class="bi bi-download"></i> <a href="datos/Pedigri_1.txt" download="Pedigri_1.txt">Pedigrí 1</a> &nbsp; <a href="datos/Pedigri_2.txt" download="Pedigri_2.txt">Pedigrí 2</a> &nbsp; <a href="datos/Pedigri_3.txt" download="Pedigri_3.txt">Pedigrí 3</a> &nbsp; <a href="datos/Pedigri_4.txt" download="Pedigri_4.txt">Pedigrí 4</a></p>
</div>
</div>
</div>
<p>Posteriormente, se generó mediante simulación utilizando la función <code>gg.Population()</code>, los fenotipos y genotipos de cada uno de los individuos de los cuatro pedigríes anteriores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Pedigri_1 <span class="op">=</span> <span class="st">'Pedigri_1.txt'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Pob_1 <span class="op">=</span> gg.Population(Gen_caracteristicas, pedFile <span class="op">=</span> Pedigri_1, generation <span class="op">=</span> <span class="va">None</span>, qtns <span class="op">=</span> QTNs, gfounders <span class="op">=</span> Gen_Pob_base)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="codigo">
<p>Para simular los fenotipos y genotipos a partir de la función <code>gg.Population()</code>, se especifica en el argumento <code>pedFile</code> el pedigrí con los individuos a los cuales dicha información se simulará. Como puede observar, algunos de los objetos generados en pasos anteriores (las características del genoma y los genotipos de la población fundadora), se especifican también aquí.</p>
</div>
<div class="aclaracion">
<p>El módulo de <code>Python</code> <code>SeqBreed</code>, simula los fenotipos (<span class="math inline">\(y_{i}\)</span>) de cada uno de los individuos del pedigrí proporcionado con base en la expresión <span class="math inline">\(y_{i} = \mu + g_{i} + e_{i}\)</span>, donde <span class="math inline">\(\mu\)</span> es la media, <span class="math inline">\(g_{i}\)</span> es el genotipo del individuo, y <span class="math inline">\(e_{i}\)</span> es el error.</p>
</div>
</section>
<section id="uso-de-subconjuntos-de-datos-con-diferentes-densidades-de-snp" class="level3">
<h3 class="anchored" data-anchor-id="uso-de-subconjuntos-de-datos-con-diferentes-densidades-de-snp">4. Uso de subconjuntos de datos con diferentes densidades de SNP</h3>
<p>Del conjunto de datos total con 100.231 SNP luego del control de calidad, se seleccionaron de forma aleatoria mediante el uso de Plink <span class="citation" data-cites="purcell2007">(<a href="#ref-purcell2007" role="doc-biblioref">Purcell et al. 2007</a>)</span>, tres subconjuntos de datos de SNP de manera que el número de marcadores aproximado fuera igual a 1.000, 10.000 y 100.000 SNP. A continuación podrá descargar los subconjuntos de datos de SNP.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><i class="bi bi-download"></i> <a href="datos/chip_1.txt" download="chip_1.txt">Chip 1</a> &nbsp; <a href="datos/chip_2.txt" download="chip_2.txt">Chip 2</a> &nbsp; <a href="datos/chip_3.txt" download="chip_3.txt">Chip 3</a></p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>den_chips <span class="op">=</span> [<span class="st">'/chip_1.txt'</span>, <span class="st">'/chip_2.txt'</span>, <span class="st">'/chip_3.txt'</span>, SNP_pos]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>chips <span class="op">=</span> []</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> den_chips:</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    chip <span class="op">=</span> gg.Chip(chipFile <span class="op">=</span> <span class="bu">file</span>, genome <span class="op">=</span> Gen_caracteristicas, name <span class="op">=</span> <span class="bu">file</span> <span class="op">+</span> <span class="st">'_chip'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    chips.append(chip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="codigo">
<p>Para generar el objeto chip, ya que este variara en los análisis que se presentaran a continuación de acuerdo a distintas densidades aproximadas de marcadores (1.000, 10.000 y 100.000), inicialmente se crea una lista con los distintos subconjuntos de datos de SNP que puede descargar en la instrucción anterior a este código. Luego, se genera el objeto chip a través de un bucle <code>for</code>.</p>
</div>
</section>
<section id="implementación-de-los-métodos-blup-y-ssgblup" class="level3">
<h3 class="anchored" data-anchor-id="implementación-de-los-métodos-blup-y-ssgblup">5. Implementación de los métodos BLUP y ssGBLUP</h3>
<p>Se usó la función <code>sel.doEbv()</code> para llevar a cabo la predicción, usando los modelos BLUP y ssGBLUP descritos anteriormente en el capítulo sobre Modelos de predicción. A continuación podrá observar todo el código que se utilizó.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ind_gen_1 <span class="op">=</span> np.arange(<span class="dv">2061</span>, dtype <span class="op">=</span> np.<span class="bu">int</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ind_fen <span class="op">=</span> np.arange(<span class="dv">461</span>, dtype <span class="op">=</span> np.<span class="bu">int</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>itrait <span class="op">=</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="codigo">
<p>.</p>
</div>
<section id="método-blup" class="level4">
<h4 class="anchored" data-anchor-id="método-blup">5.1. Método BLUP</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sel.doEbv(Pob_1, criterion <span class="op">=</span> <span class="st">'blup'</span>, yIds <span class="op">=</span> ind_fen, h2 <span class="op">=</span> <span class="fl">0.7</span>, itrait <span class="op">=</span> itrait)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ebv_aBLUP <span class="op">=</span> np.array(<span class="bu">list</span>(Pob_1.inds[i].ebv <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Pob_1.n)))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>ebv_aBLUP <span class="op">=</span> pd.DataFrame(ebv_aBLUP)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>y_aBLUP <span class="op">=</span> np.array(<span class="bu">list</span>(Pob_1.inds[i].y[itrait] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Pob_1.n)))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>y_aBLUP <span class="op">=</span> pd.DataFrame(y_aBLUP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación podrá descargar los fenotipos observados y predichos usando el método BLUP.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><i class="bi bi-download"></i> <a href="datos/Fenotipo_0.csv" download="Fenotipo_0.csv">Fenotipos observados</a> &nbsp; <a href="datos/ebv_0.csv" download="ebv_0.csv">Fenotipos predichos</a></p>
</div>
</div>
</div>
<div class="codigo">
<p>.</p>
</div>
</section>
<section id="método-ssgblup-con-densidad-de-snp-aproximada-de-1.000" class="level4">
<h4 class="anchored" data-anchor-id="método-ssgblup-con-densidad-de-snp-aproximada-de-1.000">5.2. Método ssGBLUP con densidad de SNP aproximada de 1.000</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mX_1 <span class="op">=</span> gg.do_X([Pob_1.inds[i] <span class="cf">for</span> i <span class="kw">in</span> ind_gen_1], Gen_caracteristicas, Gen_Pob_base, chips[<span class="dv">0</span>], minMaf <span class="op">=</span> <span class="fl">0.05</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>sel.doEbv(Pob_1, criterion <span class="op">=</span> <span class="st">'sstep'</span>, X <span class="op">=</span> mX_1, yIds <span class="op">=</span> ind_fen, mkrIds <span class="op">=</span> ind_gen_1, h2 <span class="op">=</span> <span class="fl">0.7</span>, nh <span class="op">=</span> Gen_caracteristicas.ploidy)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>ebv_ssGBLUP <span class="op">=</span> np.array(<span class="bu">list</span>(Pob_1.inds[i].ebv <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Pob_1.n)))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>ebv_ssGBLUP <span class="op">=</span> pd.DataFrame(ebv_ssGBLUP_3)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>y_ssGBLUP <span class="op">=</span> np.array(<span class="bu">list</span>(Pob_1.inds[i].y[itrait] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Pob_1.n)))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>y_ssGBLUP <span class="op">=</span> pd.DataFrame(y_ssGBLUP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación podrá descargar los fenotipos observados y predichos usando el método ssGBLUP con densidad de 1.000.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><i class="bi bi-download"></i> <a href="datos/Fenotipo_1.csv" download="Fenotipo_1.csv">Fenotipos observados</a> &nbsp; <a href="datos/ebv_1.csv" download="ebv_1.csv">Fenotipos predichos</a></p>
</div>
</div>
</div>
<div class="codigo">
<p>.</p>
</div>
</section>
<section id="método-ssgblup-con-densidad-de-snp-aproximada-de-10.000" class="level4">
<h4 class="anchored" data-anchor-id="método-ssgblup-con-densidad-de-snp-aproximada-de-10.000">5.3. Método ssGBLUP con densidad de SNP aproximada de 10.000</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mX_2 <span class="op">=</span> gg.do_X([Pob_1.inds[i] <span class="cf">for</span> i <span class="kw">in</span> ind_gen_1], Gen_caracteristicas, Gen_Pob_base, chips[<span class="dv">1</span>], minMaf <span class="op">=</span> <span class="fl">0.05</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sel.doEbv(Pob_1, criterion <span class="op">=</span> <span class="st">'sstep'</span>, X <span class="op">=</span> mX_2, yIds <span class="op">=</span> ind_fen, mkrIds <span class="op">=</span> ind_gen_1, h2 <span class="op">=</span> <span class="fl">0.7</span>, nh <span class="op">=</span> Gen_caracteristicas.ploidy)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>ebv_ssGBLUP <span class="op">=</span> np.array(<span class="bu">list</span>(Pob_1.inds[i].ebv <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Pob_1.n)))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>ebv_ssGBLUP <span class="op">=</span> pd.DataFrame(ebv_ssGBLUP_3)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>y_ssGBLUP <span class="op">=</span> np.array(<span class="bu">list</span>(Pob_1.inds[i].y[itrait] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Pob_1.n)))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>y_ssGBLUP <span class="op">=</span> pd.DataFrame(y_ssGBLUP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación podrá descargar los fenotipos observados y predichos usando el método ssGBLUP con densidad de 10.000.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><i class="bi bi-download"></i> <a href="datos/Fenotipo_2.csv" download="Fenotipo_2.csv">Fenotipos observados</a> &nbsp; <a href="datos/ebv_2.csv" download="ebv_2.csv">Fenotipos predichos</a></p>
</div>
</div>
</div>
</section>
<section id="método-ssgblup-con-densidad-de-snp-aproximada-de-100.000" class="level4">
<h4 class="anchored" data-anchor-id="método-ssgblup-con-densidad-de-snp-aproximada-de-100.000">5.4. Método ssGBLUP con densidad de SNP aproximada de 100.000</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mX_3 <span class="op">=</span> gg.do_X([Pob_1.inds[i] <span class="cf">for</span> i <span class="kw">in</span> ind_gen_1], Gen_caracteristicas, Gen_Pob_base, chips[<span class="dv">2</span>], minMaf <span class="op">=</span> <span class="fl">0.05</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sel.doEbv(Pob_1, criterion <span class="op">=</span> <span class="st">'sstep'</span>, X <span class="op">=</span> mX_3, yIds <span class="op">=</span> ind_fen, mkrIds <span class="op">=</span> ind_gen_1, h2 <span class="op">=</span> <span class="fl">0.7</span>, nh <span class="op">=</span> Gen_caracteristicas.ploidy)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ebv_ssGBLUP <span class="op">=</span> np.array(<span class="bu">list</span>(Pob_1.inds[i].ebv <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Pob_1.n)))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>ebv_ssGBLUP <span class="op">=</span> pd.DataFrame(ebv_ssGBLUP_3)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>y_ssGBLUP <span class="op">=</span> np.array(<span class="bu">list</span>(Pob_1.inds[i].y[itrait] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Pob_1.n)))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>y_ssGBLUP <span class="op">=</span> pd.DataFrame(y_ssGBLUP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación podrá descargar los fenotipos observados y predichos usando el método ssGBLUP con densidad de 100.000.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><i class="bi bi-download"></i> <a href="datos/Fenotipo_3.csv" download="Fenotipo_3.csv">Fenotipos observados</a> &nbsp; <a href="datos/ebv_3.csv" download="ebv_3.csv">Fenotipos predichos</a></p>
</div>
</div>
</div>
<p>Por último, se usó la correlación entre los valores fenotípicos observados y predichos como medida de predictibilidad, resultados que podrá observar a continuación.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="seqbreed_files/figure-html/Paso-4g-1.png" class="img-fluid figure-img" style="width:74.0%"></p>
</figure>
</div>
</div>
</div>
<div class="aclaracion">
<p>.</p>
</div>
</section>
</section>
<section id="referencia-bibliográfica" class="level3">
<h3 class="anchored" data-anchor-id="referencia-bibliográfica">Referencia bibliográfica</h3>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-pérez-enciso2020" class="csl-entry" role="doc-biblioentry">
Pérez-Enciso, Miguel, Lino C. Ramírez-Ayala, and Laura M. Zingaretti. 2020. <span>“SeqBreed: A Python Tool to Evaluate Genomic Prediction in Complex Scenarios.”</span> <em>Genetics Selection Evolution</em> 52 (1). <a href="https://doi.org/10.1186/s12711-020-0530-2">https://doi.org/10.1186/s12711-020-0530-2</a>.
</div>
<div id="ref-purcell2007" class="csl-entry" role="doc-biblioentry">
Purcell, Shaun, Benjamin Neale, Kathe Todd-Brown, Lori Thomas, Manuel A. R. Ferreira, David Bender, Julian Maller, et al. 2007. <span>“PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses.”</span> <em>The American Journal of Human Genetics</em> 81 (3): 559–75. <a href="https://doi.org/10.1086/519795">https://doi.org/10.1086/519795</a>.
</div>
<div id="ref-Python" class="csl-entry" role="doc-biblioentry">
Van-Rossum, G., and Jr. F. L Drake. 1995. <em>Python Reference Manual</em>. Centrum voor Wiskunde en Informatica Amsterdam.
</div>
<div id="ref-Vourlakietal" class="csl-entry" role="doc-biblioentry">
Vourlaki, I., R. Castanera, S. Ramos-Onsins, J. Casacuberta, and M. Pérez-Enciso. s.f. <span>“Transposable Element Polymorphisms Improve Prediction of Complex Agronomic Traits in Rice.”</span> <em>Frontiers in Plant Science</em>, s.f.
</div>
<div id="ref-yang2011" class="csl-entry" role="doc-biblioentry">
Yang, Jian, S. Hong Lee, Michael E. Goddard, and Peter M. Visscher. 2011. <span>“GCTA: A Tool for Genome-Wide Complex Trait Analysis.”</span> <em>The American Journal of Human Genetics</em> 88 (1): 76–82. <a href="https://doi.org/10.1016/j.ajhg.2010.11.011">https://doi.org/10.1016/j.ajhg.2010.11.011</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./model.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Modelos de predicción</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>